---
title: "Life Cycle Method"
date: 2019-11-28 20:00:10
categories: React.js
---
<br>
다음에 할 것은 data를 fetch하는 법. 이제 fetch할 차례!
이제, 우리의 movie app의 컴포를 구성해볼 것!

우리가 할 일은 componentDidMount에서 data를 fetch(loading… 출력)하는 것.
그리고 api로부터 data fetching 완료되면, 두번째 글자 대신에, map을 만들고, 영화를  render하게 만들 것.


state = {
    isLoading: true
    movies: []
  }
  componentDidMount(){
    setTimeout(() => {
      this.setState({ isLoading: false, book: true });
    }, 6000);
  }
movies: []. 걍 미래에 있을 수도 있는 것에 대한 거.
이때 state 안에 디폴트값들을 선언할 필요는 없다.


yts 사이트 api 참고.


컴포가 렌더되고나서 -> componentDidMount 실행된다: 이 컴포가 처음 render됐다는걸 알려줌.

이제 리액트에서 데이터를 fetching하는 걸 배울 것.
componentDidMount(){ 안에 js에서 쓰는 fetch() 를 쓸수 있지만,
이것보다 좋은 axios를 사용할 것. 이건 fetch위를 감싸는 작은 layer이다. 다운로드하면 사용 가능.
axios는 api데이터를 우리에게 준다. 
하지만 이 데이터를 받는 것 뿐만 아니라 잡을 필요도 있다. 
잡기(grab)까지 해야 state(변하는 데이터를 넣을 수 있음)에서 사용할 수 있다. 그래서 const를 통해 잡아놓을 것.

어쩄든, axios는 느리다. 그래서 js에게, componentDidMount 함수에게 끝날 때까지 약간 시간이 걸린다고 말해야 함. 우린 그걸 기다려야함.
그러기 위해,
 async componentDidMount(){ : 이렇게 앞에 async 붙이거나,
getMovies라는 함수 만들거나.
후자로 해볼 것.

getMovies = () => {
    const movies = axios.get("https://yts-proxy.now.sh/list_movies.json");
}
  async componentDidMount(){
    this.getMovies();
}
// 컴포가 마운트되면, 우리는 getMovie를 호출할 것. 
하지만 우린 일단 js에게, getMovie function이 시간이 좀 필요하다고 말해야 하고, 그걸 기다려야 해.



getMovies = async () => {
    const movies = await axios.get("https://yts-proxy.now.sh/list_movies.json");
  }
async 추가 : 이건 이 함수가 비동기라고 한 것. 이걸 기다려야 한다는 지시.
await 추가 : 내가 뭘 기다려야해? axios? ㅇㅋ. axios가 끝날때까지 기다렸다가 계속하게 한다.
